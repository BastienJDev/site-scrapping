<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLLINA - Gestion des Sites</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">EP</div>
                <span class="logo-text">POLLINA</span>
            </div>
            
            <nav class="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v8h8V3H3zM13 3v8h8V3h-8zM3 13v8h8v-8H3zM13 13v8h8v-8h-8z"/>
                    </svg>
                    <span>Accueil</span>
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10 9 9 9 8 9"/>
                    </svg>
                    <span>Actualit√©s</span>
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                    </svg>
                    <span>Offres d'emploi</span>
                </a>
                
                <div class="nav-item nav-dropdown">
                    <div class="nav-dropdown-toggle">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                        </svg>
                        <span>Sites juridiques</span>
                        <span class="nav-caret">‚ñæ</span>
                    </div>
                    <div class="nav-dropdown-menu">
                        <button type="button" class="nav-subitem" data-dalloz-trigger>Dalloz</button>
                    </div>
                </div>
                
                <a href="{{ url_for('bibliotheque') }}" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6m5.2-15.8l-4.2 4.2m-5.7 5.7l-4.2 4.2M23 12h-6m-6 0H1m15.8 5.2l-4.2-4.2m-5.7-5.7l-4.2-4.2"/>
                    </svg>
                    <span>Biblioth√®que PDF</span>
                </a>
                
                <a href="{{ url_for('sites_manager') }}" class="nav-item active">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                        <line x1="12" y1="22.08" x2="12" y2="12"/>
                    </svg>
                    <span>G√©rer les sites</span>
                </a>
            </nav>
            
            <div class="user-section">
                <div class="user-info">
                    <div class="user-avatar">{{ username[0].upper() if username else 'U' }}</div>
                    <span class="user-name">{{ username }}</span>
                </div>
                <a href="{{ url_for('logout') }}" class="btn-logout" title="D√©connexion">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16 17 21 12 16 7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                </a>
            </div>
        </aside>
        
        <!-- Main content -->
        <main class="main-content">
            <div class="content-header">
                <h1>Gestion des Sites</h1>
                <div class="header-actions">
                    <button class="btn-secondary" onclick="openImportModal()">üì• Importer Excel</button>
                    <button class="btn-primary" onclick="openAddSiteModal()">+ Ajouter un site</button>
                </div>
            </div>
            
            <!-- Filtres -->
            <div class="filters">
                <select id="categoryFilter" class="filter-select">
                    <option value="">Toutes les cat√©gories</option>
                </select>
            </div>
            
            <!-- Liste des sites -->
            <div class="sites-table">
                <table>
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>URL</th>
                            <th>Cat√©gorie</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="sitesTableBody">
                        <!-- Chargement dynamique -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>
    
    <!-- Modal Import Excel -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeImportModal()">&times;</span>
            <h2>Importer des sites depuis Excel</h2>
            <div class="import-info">
                <p>üìã <strong>Format requis :</strong></p>
                <ul>
                    <li><code>name</code> - Nom du site (obligatoire)</li>
                    <li><code>url</code> - URL du site (obligatoire)</li>
                    <li><code>categories</code> - Nom de la cat√©gorie (optionnel: Sites juridiques, Actualit√©s, Offres d'emploi, Autres)</li>
                    <li><code>description</code> - Description (optionnel)</li>
                </ul>
            </div>
            <form id="importForm">
                <div class="form-group">
                    <label>Fichier Excel (.xlsx, .xls, .csv)</label>
                    <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeImportModal()">Annuler</button>
                    <button type="submit" class="btn-primary">Importer</button>
                </div>
            </form>
            <div id="importResult" style="display: none; margin-top: 20px;"></div>
        </div>
    </div>
    
    <!-- Modal Ajout/√âdition Site -->
    <div id="siteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Ajouter un site</h2>
            <form id="siteForm">
                <input type="hidden" id="siteId">
                <div class="form-group">
                    <label>Nom du site</label>
                    <input type="text" id="siteName" required>
                </div>
                <div class="form-group">
                    <label>URL</label>
                    <input type="url" id="siteUrl" required>
                </div>
                <div class="form-group">
                    <label>Cat√©gorie</label>
                    <select id="siteCategory" required>
                        <option value="">S√©lectionner une cat√©gorie</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="siteDescription" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal()">Annuler</button>
                    <button type="submit" class="btn-primary">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='sites.js') }}"></script>
</body>
</html>
